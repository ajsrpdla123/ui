/* =========================
   오른쪽 팝업 전용 변수 / 레이아웃
   ========================= */
:root{
  --right-side-width: 420px;                  /* 오른쪽 팝업 기본 폭 */
  --right-topbar-h: 48px;                     /* 페이지 상단 배너 높이 */
  --right-side-gap: 12px;                     /* 화면 가장자리 여백 */
  --status-min-gap: 64px;                     /* '실시간'과 '경로오차' 최소 간격 */
}

/* #right-popup만 고정 배치 + 내부 스크롤 */
#right-popup{
  position: fixed;
  top:    calc(var(--right-topbar-h) + var(--right-side-gap));
  bottom: var(--right-side-gap);
  right:  var(--right-side-gap);
  z-index: 30;

  width: clamp(320px, 26vw, var(--right-side-width));
  max-height: calc(100vh - var(--right-topbar-h) - (var(--right-side-gap) * 2));
  overflow-y: auto;
  overscroll-behavior: contain;
  box-sizing: border-box;
}

/* 반응형 폭 튜닝 */
@media (min-width:1600px){
  :root{ --right-side-width: 480px; }
}
@media (max-width:1280px){
  :root{ --right-side-width: 360px; }
}

/* =========================
   1) 상단 버튼
   ========================= */
.top-buttons-container{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
  margin-bottom:20px;
}
.top-action-btn{
  background-color:#2c2c2c;
  border:1px solid #444;
  border-radius:8px;
  padding:10px;
  color:#e0e0e0;
  font-size:14px;
  font-family:Arial, sans-serif;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  transition:background-color .2s;
}
.top-action-btn:hover{ background-color:#3f3f3f; }
.top-action-btn img{ width:20px; height:20px; }

/* =========================
   2) 디지털 클러스터 - 카드 일체화
   ========================= */
.digital-cluster-container{
  /* 클러스터 기본 스킨은 cluster-card에서 오버라이드 */
  background-color:#1a1a1a;
  border-radius:12px;
  padding:15px;
}

/* 한 칸짜리 카드 스킨 */
.cluster-card{
  background:rgba(18,18,18,.85);
  border:1px solid #444;
  border-radius:12px;
  overflow:hidden;
  box-shadow:0 8px 24px rgba(0,0,0,.35);
  padding:0; /* 내부 여백은 각 섹션에서 관리 */
}

/* 상단 헤더(행) 공통 */
.cluster-card .cluster-row{
  background:transparent;
  border-radius:0;
  margin:0;
  padding:10px 12px;
  border-bottom:none; /* 기본 선 없음 */
}

/* 'Digital Cluster' 타이틀 줄 */
.cluster-card .cluster-header h3{
  margin:0; padding:10px 12px;
  font-size:13px; font-weight:600; color:#bfc7cd;
  background:transparent;
  border-bottom:none;
}

/* 날씨(첫 번째 row)만 살짝 분리 */
.cluster-card .cluster-row:first-of-type{
  background:rgba(255,255,255,.06) !important;
  backdrop-filter:blur(6px);
  -webkit-backdrop-filter:blur(6px);
  border-bottom:1px solid rgba(255,255,255,.10) !important;
  border-radius:12px 12px 0 0;
}

/* 클러스터 내부 기본 위젯 */
.cluster-widget{ display:flex; align-items:center; gap:8px; font-size:14px; }
.cluster-widget img{ width:24px; height:24px; }
.cluster-widget .value{ font-size:20px; font-weight:700; color:#fff; }
.cluster-widget .unit{ font-size:14px; color:#ccc; margin-left:2px; }

/* =========================
   3) 실시간 차량 상태 + 경로 오차 (한 줄)
   ========================= */
.vehicle-status-widget .status-main-line{
  display:flex;
  align-items:center;
  flex-wrap:nowrap;         /* 항상 한 줄 */
  width:100%;
  gap:8px;
}
.vehicle-status-widget .title-with-icon{
  display:flex; align-items:center; gap:8px; min-width:0;
  color:var(--text-muted, #9aa6ad); font-size:13px;
}
.vehicle-status-widget .title-with-icon span{
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.vehicle-status-widget .status-main-line .value{
  margin-left:auto;         /* 오른쪽 끝 정렬 */
  padding-left: var(--status-min-gap); /* 좌/우 그룹 최소 간격 확보 */
  display:flex; align-items:baseline; gap:6px; white-space:nowrap;
}
.vehicle-status-widget .status-main-line .value .label{
  font-size:14px; color:var(--text-muted, #9aa6ad);
}
#deviation-value{ font-size:20px; font-weight:700; letter-spacing:.2px; }
.vehicle-status-widget .status-main-line .value small{
  font-size:12px; color:var(--text-muted, #9aa6ad);
}

/* =========================
   4) 3D 트랙터 섹션
   ========================= */
.tractor-graphic-view{
  position:relative;
  height:420px; min-height:420px;
  border:0; border-radius:0; margin:0 0 6px 0; /* 카드와 자연스러운 간격 */
  overflow:hidden;
  background-color:transparent;
}
#renderCanvas{
  width:100%; height:100%; display:block;
  outline:none; position:relative; z-index:2;
}

/* 트랙터 아래 속도감 효과 */
.tractor-graphic-view::after{
  content:''; position:absolute; bottom:0; left:50%; z-index:1;
  width:65%; height:300%;
  transform-origin:bottom center;
  transform:translateX(-50%) perspective(200px) rotateX(15deg);
  background:linear-gradient(to top, #ffffff, #1f410a 20%, #ffffff 100%);
  background-size:200% 150%;
  animation:moveRoadMarkers 1.0s linear infinite;
}
@keyframes moveRoadMarkers{
  from{ background-position-y:0; }
  to{ background-position-y:-13%; }
}

/* =========================
   5) 게이지
   ========================= */
.gauges-row{
  display:grid;
  grid-template-columns:repeat(3, 1fr);
  background-color:#2c2c2c; /* 기본 스타일(별도 카드가 아니면 사용) */
  border-radius:8px;
  padding:15px 10px;
  text-align:center;
}
.gauge .label{ font-size:12px; color:#9e9e9e; display:block; margin-bottom:5px; }
.gauge .value{ font-size:24px; font-weight:700; color:#fff; }
.gauge .unit{ font-size:12px; color:#ccc; }

/* 게이지를 별도 카드로 분리하고 싶을 때(있으면 우선 적용) */
.cluster-card .gauges-card{
  margin:10px 10px 12px;
  background:rgba(17,17,17,.9);
  border:1px solid #444;
  border-radius:10px;
  box-shadow:0 6px 16px rgba(0,0,0,.35);
  overflow:hidden;
}
.cluster-card .gauges-card .gauges-row{
  background:transparent !important;
  border:none !important;
  margin:0 !important;
  padding:14px 12px !important;
  border-radius:0 !important;
}
.cluster-card .gauges-card .gauge .label{ color:#a6b0b6; }
.cluster-card .gauges-card .gauge .value{ color:#fff; }
.cluster-card .gauges-card .gauge .unit{ color:#9aa6ad; }

/* =========================
   6) 기타(사용 안 하는 과거 스타일 정리)
   ========================= */
.main-status-display{ display:none; }
/* ===== RIGHT popup safety overrides ===== */

#right-popup{ 
  display:block !important; 
  z-index: 1000 !important;    /* 지도/캔버스보다 위로 */
}

#right-popup.hidden{ display:none !important; }
#right-popup.visible{ display:block !important; }

/* 위치/크기 보정이 없다면(혹시 지웠다면) 기본값 보강 */
#right-popup{
  position: fixed;
  top:    calc(var(--right-topbar-h, 48px) + var(--right-side-gap, 12px));
  bottom: var(--right-side-gap, 12px);
  right:  var(--right-side-gap, 12px);
  width: clamp(320px, 26vw, 420px);
  max-height: calc(100vh - var(--right-topbar-h, 48px) - (var(--right-side-gap, 12px) * 2));
  overflow-y: auto;
  box-sizing: border-box;
}
/* === RIGHT: 화면 밖으로 밀림 방지/폭 자동 조절/변환 초기화 === */
:root{
  --center-min: 640px;        /* left.css와 동일 값 유지 */
  --right-side-gap: 12px;
}

#right-popup{
  position: fixed;
  top:    calc(var(--right-topbar-h, 48px) + var(--right-side-gap));
  bottom: var(--right-side-gap);
  right:  max(env(safe-area-inset-right), var(--right-side-gap));
  left:   auto;

  width: clamp(300px,
               calc((100vw - var(--center-min)) / 2 - var(--right-side-gap)),
               420px);
  max-width: 48vw;

  max-height: calc(100vh - var(--right-topbar-h, 48px) - (var(--right-side-gap) * 2));
  overflow-y: auto;
  overflow-x: hidden;
  box-sizing: border-box;

  transform: none !important;
  margin: 0 !important;
}

@media (max-width: 1280px){
  #right-popup{
    width: clamp(280px, calc(45vw - var(--right-side-gap)), 380px);
  }
}
/* ====== Quick Status Strip (주행모드/차량오차/수신상태) ====== */
.status-quick-cards{
  display: grid;
  grid-template-columns: repeat(3,1fr);
  gap: 10px;
  padding: 10px 10px 2px;
  margin: 6px 0 10px;
  background: transparent;     /* 본문과 자연스럽게 이어지게 */
}

.status-quick-cards .qcard{
  display: grid;
  grid-template-rows: auto auto 1fr;
  align-items: center;
  justify-items: center;
  gap: 6px;
  padding: 10px 8px;
  background: rgba(32,32,32,0.65);
  border: 1px solid #3a3a3a;
  border-radius: 10px;
}

.status-quick-cards .qicon img{ width: 20px; height: 20px; display:block; }

.status-quick-cards .qlabel{
  font-size: 12px; color: #a6b0b6;
}

.status-quick-cards .qvalue{
  font-size: 16px; font-weight: 700; color: #fff;
}
.status-quick-cards .qvalue small{
  font-size: 12px; font-weight: 400; color: #9aa6ad; margin-left: 4px;
}

/* 수신상태 뱃지 */
.qbadge{
  font-size: 12px; font-weight: 700;
  padding: 4px 8px;
  border-radius: 999px;
  line-height: 1;
  color: #0b1720;
  background: #7bd3ff;              /* 기본: REPLAY(파랑) */
  border: 1px solid rgba(255,255,255,0.08);
}
.qbadge.online { background:#68d8ac; color:#0c1d16; }     /* LIVE(초록) */
.qbadge.offline{ background:#ff8a8a; color:#2b0e0e; }     /* OFF(빨강) */
/* ============ 고정 카드 스킨 ============ */
#right-popup .digital-cluster-container.cluster-card{
  padding:0 !important;
  background: rgba(18,18,18,.85) !important;
  border:1px solid #444 !important;
  border-radius:12px !important;
  overflow:hidden !important;
  box-shadow:0 8px 24px rgba(0,0,0,.35) !important;
}

/* 상단 타이틀 */
#right-popup .digital-cluster-container.cluster-card .cluster-header h3{
  margin:0; padding:10px 12px;
  font-size:13px; font-weight:600; color:#bfc7cd;
  background: transparent !important;
  border-bottom: none !important;
}

/* 모든 row의 기본 배경/보더 제거 */
#right-popup .digital-cluster-container.cluster-card .cluster-row{
  background: transparent !important;
  border: none !important;
  margin: 0 !important;
  padding: 10px 12px !important;
  border-radius: 0 !important;
}

/* 날씨 행만 살짝 분리 */
#right-popup .digital-cluster-container.cluster-card .weather-row{
  background: rgba(255,255,255,0.06) !important;
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  border-bottom: 1px solid rgba(255,255,255,.10) !important;
  border-radius: 12px 12px 0 0 !important;
}

/* 실시간 차량 상태 한 줄 정렬 */
.vehicle-status-widget .status-main-line{
  display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:nowrap;
}
.vehicle-status-widget .title-with-icon{ display:flex; align-items:center; gap:8px; min-width:0; color:#9aa6ad; font-size:13px; }
.vehicle-status-widget .title-with-icon span{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.vehicle-status-widget .status-main-line .value{ margin-left:auto; display:flex; align-items:baseline; gap:6px; white-space:nowrap; }
#deviation-value{ font-size:20px; font-weight:700; letter-spacing:.2px; }
.vehicle-status-widget .status-main-line .value .label{ font-size:14px; color:#9aa6ad; }
.vehicle-status-widget .status-main-line .value small{ font-size:12px; color:#9aa6ad; }

/* 미니카드 3개 스트립 */
.quick-strip{
  display:grid; grid-template-columns: repeat(3, 1fr);
  gap:12px; padding: 6px 12px 10px;
}
.qcard{
  border:1px solid #394148; border-radius:12px;
  background: rgba(32,32,32,0.55);
  padding:10px 12px; min-height:64px;
  display:flex; flex-direction:column; justify-content:center; gap:6px;
}
.qtitle{ font-size:12px; color:#9aa6ad; }
.qvalue{ font-size:18px; font-weight:700; color:#fff; display:flex; align-items:center; gap:6px; }
.qvalue small{ font-size:12px; color:#9aa6ad; }
.qbadge{ display:inline-flex; align-items:center; justify-content:center; padding:4px 8px; border-radius:8px; font-size:13px; font-weight:700; }
.q-ok{ background:#0e7a4e; color:#eafff4; }
.qicon{ width:18px; height:18px; opacity:.95; }

/* 3D 섹션은 카드에 붙게 */
.cluster-card .tractor-graphic-view{ height:420px; margin:0 0 6px 0 !important; border:0 !important; border-radius:0 !important; }

/* 게이지를 별도 카드처럼 */
.cluster-card .gauges-card{ margin:10px 10px 12px; background:rgba(17,17,17,.9); border:1px solid #444; border-radius:10px; box-shadow:0 6px 16px rgba(0,0,0,.35); }
.cluster-card .gauges-card .gauges-row{ background:transparent !important; border:none !important; margin:0 !important; padding:14px 12px !important; border-radius:0 !important; }
/* --- 미니정보 스트립(테두리 없이) --- */
.quick-strip{
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap:12px;
  padding: 6px 10px 0 10px;
  align-items: center;
}
.qcard{ background: transparent; border: 0; padding: 0; }
.qtitle{ font-size:12px; color:#aeb6bc; margin-bottom:4px; }
.qvalue{ display:flex; align-items:center; gap:6px; font-weight:600; color:#e8eef2; }
.qicon{ width:16px; height:16px; opacity:.9; }
.qbadge{
  padding:4px 10px; border-radius:999px; font-size:12px; line-height:1;
  background: rgba(255,255,255,.08); color:#e8eef2; border:1px solid rgba(255,255,255,.12);
}
.qbadge.q-ok{ background: rgba(66, 255, 171, .12); color:#46e5a4; border-color: rgba(46, 214, 150, .35); }

/* --- 중앙 큰 ‘차량 오차’ --- */
.center-error{
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  padding: 8px 0 4px;
}
.center-error-label{
  font-size:14px; color:#cfd6db; letter-spacing:.2px; margin-bottom:2px;
}
.center-error-value{ display:flex; align-items:baseline; gap:8px; }
.center-error-value #vehicle-error-big{
  font-size:64px; font-weight:800; color:#ffb74d; /* 이미지 느낌의 주황 */
  line-height:1; letter-spacing:.5px; text-shadow: 0 2px 10px rgba(0,0,0,.4);
}
.center-error-value small{
  font-size:20px; color:#e6e6e6; opacity:.9;
}

/* 카드와 3D 사이 간격 최소화 */
.cluster-card .tractor-graphic-view{ margin-top: 4px !important; }

/* ‘실시간 차량 상태 | 경로오차’ 한 줄 유지 및 간격 확보 */
.vehicle-status-widget .status-main-line{
  display:flex; align-items:center; flex-wrap:nowrap; gap:8px; width:100%;
}
.vehicle-status-widget .title-with-icon{ display:flex; align-items:center; gap:8px; min-width:0; }
.vehicle-status-widget .status-main-line .value{
  margin-left:auto; padding-left:64px; display:flex; align-items:baseline; gap:6px; white-space:nowrap;
}

/* 날씨 행을 살짝 분리(있으면) */
.cluster-card .weather-row{
  background: rgba(255,255,255,0.06) !important;
  border-bottom: 1px solid rgba(255,255,255,0.10) !important;
  border-radius: 12px 12px 0 0;
  padding: 10px 12px !important;
}
/* ========== [RIGHT STATUS STRIP OVERRIDE] ========== */
/* 컨테이너: 한 줄 3등분(좌:주행모드 | 중:차량오차 | 우:수신상태) */
#right-popup .status-quick-cards,
#right-popup .quick-strip{
  display: grid !important;
  grid-template-columns: 1fr auto 1fr !important;  /* 가운데 고정폭(오차), 좌우는 유동 */
  align-items: center !important;
  gap: 12px !important;
  padding: 8px 10px !important;
  margin: 6px 0 10px !important;
}

/* 카드 공통: 테두리/배경 제거하고 라벨+값만 정렬 */
#right-popup .status-quick-cards .qcard,
#right-popup .quick-strip .qcard{
  background: transparent !important;
  border: 0 !important;
  padding: 0 !important;
  min-height: auto !important;
  display: grid !important;
  grid-template-rows: auto auto !important;
  align-content: center !important;
  gap: 4px !important;
}

/* 좌측(주행모드) = 첫 번째 요소 */
#right-popup .status-quick-cards .qcard:nth-child(1),
#right-popup .quick-strip .qcard:nth-child(1){
  justify-items: start !important;
  text-align: left !important;
}

/* 가운데(차량오차) = 두 번째 요소 : 크게 중앙 정렬 */
#right-popup .status-quick-cards .qcard:nth-child(2),
#right-popup .quick-strip .qcard:nth-child(2){
  justify-items: center !important;
  text-align: center !important;
}
#right-popup .status-quick-cards .qcard:nth-child(2) .qtitle,
#right-popup .quick-strip .qcard:nth-child(2) .qtitle{
  font-size: 13px !important;
  color: #cfd6db !important;
  letter-spacing: .2px;
}
#right-popup .status-quick-cards .qcard:nth-child(2) .qvalue,
#right-popup .quick-strip .qcard:nth-child(2) .qvalue{
  display: flex !important;
  align-items: baseline !important;
  gap: 8px !important;
  font-weight: 800 !important;
}
#right-popup .status-quick-cards .qcard:nth-child(2) .qvalue strong,
#right-popup .quick-strip .qcard:nth-child(2) .qvalue strong,
#vehicle-error-big{
  font-size: 56px !important;       /* 가운데 큰 숫자(오차) */
  line-height: 1 !important;
  color: #ffb74d !important;
  text-shadow: 0 2px 10px rgba(0,0,0,.4) !important;
}
#right-popup .status-quick-cards .qcard:nth-child(2) .qvalue small,
#right-popup .quick-strip .qcard:nth-child(2) .qvalue small{
  font-size: 18px !important;
  opacity: .9 !important;
}

/* 우측(수신상태) = 세 번째 요소 : 우측 정렬 + 뱃지 오른쪽 끝 */
#right-popup .status-quick-cards .qcard:nth-child(3),
#right-popup .quick-strip .qcard:nth-child(3){
  justify-items: end !important;
  text-align: right !important;
}
#right-popup .status-quick-cards .qcard:nth-child(3) .qvalue,
#right-popup .quick-strip .qcard:nth-child(3) .qvalue{
  justify-content: flex-end !important;
}
#right-popup .status-quick-cards .qbadge,
#right-popup .quick-strip .qbadge{
  padding: 4px 10px !important;
  border-radius: 999px !important;
  font-size: 12px !important;
  line-height: 1 !important;
  border: 1px solid rgba(255,255,255,.12) !important;
}

/* 타이틀/아이콘/텍스트 줄맞춤 + 넘침 방지 */
#right-popup .qtitle{ 
  white-space: nowrap !important; 
  overflow: hidden !important; 
  text-overflow: ellipsis !important; 
}
#right-popup .qvalue{
  display: inline-flex !important;
  align-items: center !important;
  gap: 6px !important;
  white-space: nowrap !important;
}
#right-popup .qicon{ width: 16px !important; height: 16px !important; }

/* 폭이 좁을 때도 한 줄 유지 */
@media (max-width: 1280px){
  #right-popup .status-quick-cards,
  #right-popup .quick-strip{
    grid-template-columns: 1fr auto 1fr !important;
  }
}
/* === 좌/중/우 정렬: 좌우는 가장자리에 밀착, 가운데는 정확히 중앙 === */
#right-popup .status-quick-cards,
#right-popup .quick-strip{
  display: grid !important;
  grid-template-columns: auto 1fr auto !important; /* 좌(내용폭) | 가운데(가변) | 우(내용폭) */
  align-items: center !important;
  justify-items: stretch !important;
  gap: 0 !important;                 /* 칸 사이 간격 제거 */
  padding-left: 0 !important;        /* 좌우 여백 제거 → 가장자리에 밀착 */
  padding-right: 0 !important;
}

/* 각 qcard 내부 여백 제거(겉 가장자리와 딱 붙게) */
#right-popup .status-quick-cards .qcard,
#right-popup .quick-strip .qcard{
  padding: 0 !important;
  margin: 0 !important;
  background: transparent !important;
  border: 0 !important;
}

/* 1번째 = 주행모드: 왼쪽 끝 정렬 */
#right-popup .status-quick-cards .qcard:nth-child(1),
#right-popup .quick-strip .qcard:nth-child(1){
  justify-self: start !important;
  text-align: left !important;
}

/* 2번째 = 차량오차: 가운데 정렬(큰 값 유지) */
#right-popup .status-quick-cards .qcard:nth-child(2),
#right-popup .quick-strip .qcard:nth-child(2){
  justify-self: center !important;
  text-align: center !important;
}

/* 3번째 = 수신상태: 오른쪽 끝 정렬 */
#right-popup .status-quick-cards .qcard:nth-child(3),
#right-popup .quick-strip .qcard:nth-child(3){
  justify-self: end !important;
  text-align: right !important;
}

/* 타이틀/값 줄바꿈 방지(폭 줄어도 한 줄 유지) */
#right-popup .qtitle,
#right-popup .qvalue{
  white-space: nowrap !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
}

/* 폭이 좁을 때도 레이아웃 유지 */
@media (max-width:1280px){
  #right-popup .status-quick-cards,
  #right-popup .quick-strip{
    grid-template-columns: auto 1fr auto !important;
  }
}
/* === 좌/우를 카드 가장자리까지 붙이기 === */
/* cluster-card 내부 기본 패딩(좌/우 12px)을 상쇄 */
#right-popup .cluster-card .quick-strip,
#right-popup .cluster-card .status-quick-cards{
  margin-left: -12px !important;
  margin-right: -12px !important;
  padding-left: 12px !important;   /* 내용은 그대로 보존 */
  padding-right: 12px !important;
  column-gap: 0 !important;        /* 칸 사이 간격 제거 */
  grid-template-columns: max-content 1fr max-content !important; /* 좌/중/우 */
}

/* 좌=주행모드 : 왼쪽 끝 정렬 */
#right-popup .cluster-card .quick-strip .qcard:nth-child(1),
#right-popup .cluster-card .status-quick-cards .qcard:nth-child(1){
  justify-self: start !important;
  text-align: left !important;
  padding-left: 0 !important;
}

/* 중=차량오차 : 중앙 정렬 */
#right-popup .cluster-card .quick-strip .qcard:nth-child(2),
#right-popup .cluster-card .status-quick-cards .qcard:nth-child(2){
  justify-self: center !important;
  text-align: center !important;
}

/* 우=수신상태 : 오른쪽 끝 정렬 */
#right-popup .cluster-card .quick-strip .qcard:nth-child(3),
#right-popup .cluster-card .status-quick-cards .qcard:nth-child(3){
  justify-self: end !important;
  text-align: right !important;
  padding-right: 0 !important;
}

/* 내용 줄바꿈 방지(폭 줄어도 한 줄 유지) */
#right-popup .qtitle, #right-popup .qvalue{
  white-space: nowrap !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
}
/* ==== 풀블리드 + 좌·중·우 정렬 강제 ==== */
/* quick-strip 또는 status-quick-cards 어느 쪽이든 적용 */
#right-popup .cluster-card :is(.quick-strip, .status-quick-cards){
  /* 부모 패딩이 남아 있어도 가장자리까지 꽉 채우기 */
  width: calc(100% + 24px) !important;  /* 좌우 12px씩 확장 */
  transform: translateX(-12px) !important;

  /* 한 줄 3칸: 좌(내용폭) | 가운데(가변) | 우(내용폭) */
  display: grid !important;
  grid-template-columns: max-content 1fr max-content !important;
  align-items: center !important;
  gap: 0 !important;

  /* 내부 패딩/마진 제거 → 진짜 카드 가장자리와 맞닿게 */
  padding: 0 !important;
  margin: 0 !important;
}

/* 1번째 = 주행모드 : 왼쪽 끝 */
#right-popup .cluster-card :is(.quick-strip, .status-quick-cards) .qcard:nth-child(1){
  justify-self: start !important;
  text-align: left !important;
}

/* 2번째 = 차량오차 : 정확히 중앙 */
#right-popup .cluster-card :is(.quick-strip, .status-quick-cards) .qcard:nth-child(2){
  justify-self: center !important;
  text-align: center !important;
}

/* 3번째 = 수신상태 : 오른쪽 끝 */
#right-popup .cluster-card :is(.quick-strip, .status-quick-cards) .qcard:nth-child(3){
  justify-self: end !important;
  text-align: right !important;
}

/* 줄바꿈 방지(폭 줄어도 한 줄 유지) */
#right-popup .qtitle, #right-popup .qvalue{
  white-space: nowrap !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
}
/* ======= RIGHT 상단 스트립: 좌/중/우 강제 배치 ======= */
#right-popup .cluster-card .quick-strip,
#right-popup .cluster-card .status-quick-cards{
  position: relative !important;
  display: flex !important;
  align-items: center !important;
  justify-content: space-between !important;

  /* 카드 안쪽 12px 패딩 상쇄 → 카드 테두리까지 붙임 */
  margin-left: -12px !important;
  margin-right: -12px !important;
  padding: 0 12px !important;

  min-height: 42px;  /* 중앙 절대배치 높이 확보 */
  gap: 0 !important;
}

/* 중앙(2번째 카드)을 진짜 '정중앙'에 고정 */
#right-popup .cluster-card :is(.quick-strip,.status-quick-cards) .qcard:nth-child(2){
  position: absolute !important;
  left: 50% !important;
  transform: translateX(-50%) !important;
  text-align: center !important;
  margin: 0 !important;
  padding: 0 !important;
}

/* 좌(1번째)는 왼쪽 끝, 우(3번째)는 오른쪽 끝에 밀착 */
#right-popup .cluster-card :is(.quick-strip,.status-quick-cards) .qcard:nth-child(1){
  align-self: center !important;
  justify-self: flex-start !important;
  text-align: left !important;
  margin: 0 !important; padding: 0 !important;
}
#right-popup .cluster-card :is(.quick-strip,.status-quick-cards) .qcard:nth-child(3){
  align-self: center !important;
  justify-self: flex-end !important;
  text-align: right !important;
  margin: 0 !important; padding: 0 !important;
}

/* 라벨/값 줄바꿈 방지 */
#right-popup .qtitle, #right-popup .qvalue{
  white-space: nowrap !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
}
/* 좌/우 가장자리에 붙이되, 주행모드(1번째)만 살짝 안쪽으로 */
#right-popup .cluster-card :is(.quick-strip,.status-quick-cards){
  margin-left: -12px !important;     /* 카드 패딩 상쇄 */
  margin-right: -12px !important;
  padding: 0 12px !important;        /* 내용 기본 패딩 */
  position: relative !important;
  display: flex !important;
  align-items: center !important;
  justify-content: space-between !important;
}

/* 주행모드: 컷팅 방지용 좌측 완충 패딩 */
#right-popup .cluster-card :is(.quick-strip,.status-quick-cards) .qcard:nth-child(1){
  padding-left: max(8px, env(safe-area-inset-left)) !important; /* 8px 여유 */
  margin: 0 !important;
  text-align: left !important;
}

/* 차량오차: 중앙 고정(겹침 허용) */
#right-popup .cluster-card :is(.quick-strip,.status-quick-cards) .qcard:nth-child(2){
  position: absolute !important;
  left: 50% !important;
  transform: translateX(-50%) !important;
  text-align: center !important;
}

/* 수신상태: 오른쪽 끝 + 살짝 안쪽 완충 */
#right-popup .cluster-card :is(.quick-strip,.status-quick-cards) .qcard:nth-child(3){
  padding-right: max(8px, env(safe-area-inset-right)) !important;
  text-align: right !important;
}
/* --- 상단 상태 스트립을 3D 섹션 위로 올림 --- */
#right-popup .cluster-card .quick-strip,
#right-popup .cluster-card .status-quick-cards{
  position: relative !important;
  z-index: 10 !important;   /* 캔버스/도로 보다 위 */
}

/* --- 3D 섹션의 도로 효과를 가장 뒤로 내림 --- */
#right-popup .cluster-card .tractor-graphic-view{
  position: relative !important;
  z-index: 0 !important;
}
#right-popup .cluster-card .tractor-graphic-view::after{
  z-index: 0 !important;    /* 기존 1 → 0 (텍스트 가리지 않게) */
}

/* 캔버스는 도로보다 앞이되, 스트립보다 뒤 */
#right-popup .cluster-card #renderCanvas{
  z-index: 1 !important;    /* quick-strip(10) <— 위 / 도로(0) <— 아래 */
}

/* 필요하면 살짝 간격 추가(선택) */
#right-popup .cluster-card .quick-strip{ margin-bottom: 4px !important; }
/* ===== 상단 3분할 스트립: 좌/중/우 안전 여백 + 겹침 해소 ===== */

/* 스트립 자체를 카드 안쪽 12~14px 패딩으로 유지(가장자리 잘림 방지) */
#right-popup .cluster-card .quick-strip{
  position: relative !important;
  display: grid !important;
  grid-template-columns: max-content 1fr max-content !important; /* 좌 | 중앙 | 우 */
  align-items: end !important;
  column-gap: 0 !important;

  padding: 0 14px !important;     /* <- 좌/우 잘림 방지 */
  margin: 0 !important;
  min-height: 58px !important;     /* 큰 숫자 높이 확보 */
  overflow: visible !important;    /* 라벨이 살짝 커져도 표시 */
  z-index: 10 !important;          /* 3D보다 위 */
}

/* 좌/우 qcard 내부에 소폭 패딩으로 시각적 여유 */
#right-popup .quick-strip .qcard.left  { justify-self: start !important;  text-align: left !important;  padding-left: 2px !important; }
#right-popup .quick-strip .qcard.right { justify-self: end !important;    text-align: right !important; padding-right: 2px !important; }
#right-popup .quick-strip .qcard.center{ justify-self: center !important; text-align: center !important; }

/* 가운데 큰 값(차량 오차) - 스트립 안에서만 배치, 절대배치 금지 */
#right-popup .quick-strip .center .center-error{
  position: relative !important;
  transform: none !important;
  margin: 0 !important;
  padding: 0 !important;
  pointer-events: none;            /* 캔버스 조작 방해하지 않도록 */
}
#right-popup .quick-strip .center .center-error-value #vehicle-error-big{
  display: inline-block;
  line-height: 1;
}

/* 스트립과 3D 사이에 안전 간격(겹침 방지) */
#right-popup .cluster-card .quick-strip{ margin-bottom: 10px !important; }

/* 3D 도로 레이어는 더 뒤로 */
#right-popup .cluster-card .tractor-graphic-view{ position: relative !important; z-index: 0 !important; }
#right-popup .cluster-card .tractor-graphic-view::after{ z-index: 0 !important; }
#right-popup .cluster-card #renderCanvas{ z-index: 1 !important; }

/* 텍스트 넘침 보호 */
#right-popup .quick-strip .qtitle, 
#right-popup .quick-strip .qvalue{
  white-space: nowrap !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  min-width: 0;
}
/* ===== 상단 3분할 스트립: 우측 여백 확대 + 중앙 숫자 살짝 하향 ===== */

/* 스트립 좌우 패딩 확장(우측 더 넉넉하게) */
#right-popup .cluster-card .quick-strip{
  padding-left: 10px !important;
  padding-right: 10px !important;           /* ← 수신상태 잘림 방지 */
  margin-bottom: 10px !important;           /* 3D와 간격 */
  overflow: visible !important;
  z-index: 10 !important;
}

/* 오른쪽 카드(수신상태)만 추가 완충 */
#right-popup .quick-strip .qcard.right{
  padding-right: 10px !important;            /* 가장자리 여유 */
  justify-self: end !important;
  text-align: right !important;
  min-width: 0 !important;
}

/* 가운데 ‘차량 오차’ 블록을 살짝 아래로 */
#right-popup .quick-strip .qcard.center .center-error{
  margin-top: 8px !important;               /* 필요하면 8~10px로 늘려도 됨 */
}
#right-popup .quick-strip .qcard.center .center-error-value #vehicle-error-big{
  line-height: 1 !important;
}

/* 3D 도로/캔버스는 뒤로 유지 */
#right-popup .cluster-card .tractor-graphic-view{ position: relative !important; z-index: 0 !important; }
#right-popup .cluster-card .tractor-graphic-view::after{ z-index: 0 !important; }
#right-popup .cluster-card #renderCanvas{ z-index: 1 !important; }

/* 폭이 좁은 화면에서는 우측 여백을 더 키움 */
@media (max-width: 1280px){
  #right-popup .cluster-card .quick-strip{
    padding-right: 20px !important;
  }
}
/* === [최종] 상단 상태 스트립: 좌/우는 끝에, '차량 오차'는 스트립 아래 중앙 고정 === */
#right-popup .cluster-card .quick-strip{
  position: relative !important;
  display: grid !important;
  grid-template-columns: max-content 1fr max-content !important; /* 좌 | 여유 | 우 */
  align-items: center !important;
  padding: 0 16px !important;        /* 우측 여유 조금 더 */
  margin: 0 0 36px 0 !important;     /* ↓ 아래로 숫자 들어갈 공간 확보 */
  z-index: 10 !important;            /* 3D 위 */
  overflow: visible !important;
}

/* 좌/우 카드 안정화 */
#right-popup .cluster-card .quick-strip .qcard{
  min-width: 0 !important;
  margin: 0 !important;
  padding: 0 !important;
  background: transparent !important;
  border: 0 !important;
}
#right-popup .cluster-card .quick-strip .qcard.left  { justify-self: start !important; text-align: left !important; }
#right-popup .cluster-card .quick-strip .qcard.right { justify-self: end   !important; text-align: right !important; }

/* 가운데(차량 오차)만 그리드 흐름에서 분리해 스트립 '아래' 중앙에 띄움 */
#right-popup .cluster-card .quick-strip .qcard.center{
  position: absolute !important;
  left: 50% !important;
  top: calc(100% + 4px) !important;  /* 스트립 바로 아래 */
  transform: translateX(-50%) !important;
  width: auto !important;
  pointer-events: none !important;
  z-index: 11 !important;            /* 캔버스보다 위 */
  margin: 0 !important;
  padding: 0 !important;
  text-align: center !important;
}
#right-popup .cluster-card .quick-strip .qcard.center .center-error{ margin:0 !important; padding:0 !important; }
#right-popup .cluster-card .quick-strip .qcard.center .center-error-label{ margin-bottom:2px !important; }
#right-popup .cluster-card .quick-strip .qcard.center #vehicle-error-big{
  font-size: 56px !important; line-height: 1 !important;
}

/* 3D 레이어 관계(숫자가 항상 위) */
#right-popup .cluster-card .tractor-graphic-view{ position: relative !important; z-index: 0 !important; }
#right-popup .cluster-card .tractor-graphic-view::after{ z-index: 0 !important; }
#right-popup .cluster-card #renderCanvas{ z-index: 1 !important; }

/* 텍스트 넘침 보호 */
#right-popup .cluster-card .quick-strip .qtitle,
#right-popup .cluster-card .quick-strip .qvalue{
  white-space: nowrap !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
}
/* === [최종] 상단 상태 스트립: 좌/우는 끝에, '차량 오차'는 스트립 아래 중앙 고정 === */
#right-popup .cluster-card .quick-strip{
  position: relative !important;
  display: grid !important;
  grid-template-columns: max-content 1fr max-content !important; /* 좌 | 여유 | 우 */
  align-items: center !important;
  padding: 0 16px !important;        /* 우측 여유 조금 더 */
  margin: 0 0 36px 0 !important;     /* ↓ 아래로 숫자 들어갈 공간 확보 */
  z-index: 10 !important;            /* 3D 위 */
  overflow: visible !important;
}

/* 좌/우 카드 안정화 */
#right-popup .cluster-card .quick-strip .qcard{
  min-width: 0 !important;
  margin: 0 !important;
  padding: 0 !important;
  background: transparent !important;
  border: 0 !important;
}
#right-popup .cluster-card .quick-strip .qcard.left  { justify-self: start !important; text-align: left !important; }
#right-popup .cluster-card .quick-strip .qcard.right { justify-self: end   !important; text-align: right !important; }

/* 가운데(차량 오차)만 그리드 흐름에서 분리해 스트립 '아래' 중앙에 띄움 */
#right-popup .cluster-card .quick-strip .qcard.center{
  position: absolute !important;
  left: 50% !important;
  top: calc(100% + 4px) !important;  /* 스트립 바로 아래 */
  transform: translateX(-50%) !important;
  width: auto !important;
  pointer-events: none !important;
  z-index: 11 !important;            /* 캔버스보다 위 */
  margin: 0 !important;
  padding: 0 !important;
  text-align: center !important;
}
#right-popup .cluster-card .quick-strip .qcard.center .center-error{ margin:0 !important; padding:0 !important; }
#right-popup .cluster-card .quick-strip .qcard.center .center-error-label{ margin-bottom:2px !important; }
#right-popup .cluster-card .quick-strip .qcard.center #vehicle-error-big{
  font-size: 56px !important; line-height: 1 !important;
}

/* 3D 레이어 관계(숫자가 항상 위) */
#right-popup .cluster-card .tractor-graphic-view{ position: relative !important; z-index: 0 !important; }
#right-popup .cluster-card .tractor-graphic-view::after{ z-index: 0 !important; }
#right-popup .cluster-card #renderCanvas{ z-index: 1 !important; }

/* 텍스트 넘침 보호 */
#right-popup .cluster-card .quick-strip .qtitle,
#right-popup .cluster-card .quick-strip .qvalue{
  white-space: nowrap !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
}
/* ===== Quick-Strip 폭 축소(좌우 잘림 방지) ===== */
:root{ --qs-side-gutter: 18px; }  /* 좌우 여백(필요시 16~24px로 조절) */

#right-popup .cluster-card .quick-strip{
  /* 이전 오버라이드 초기화 */
  width: auto !important;
  transform: none !important;
  margin-left: 0 !important;
  margin-right: 0 !important;

  /* 폭 축소: 카드 폭에서 좌우 gutter만큼 줄이고 가운데 정렬 */
  box-sizing: border-box !important;
  width: calc(100% - (var(--qs-side-gutter) * 2)) !important;
  margin: 0 auto 38px !important;          /* 아래 공간은 중앙 숫자용 */

  padding: 0 !important;                    /* 내부 패딩은 카드들에 맡김 */
  display: grid !important;
  grid-template-columns: max-content 1fr max-content !important;
  align-items: center !important;
  overflow: visible !important;
  z-index: 10 !important;
}

/* 좌/우 카드 약간의 완충 여백 */
#right-popup .quick-strip .qcard.left  { justify-self: start !important;  padding-left: 4px !important; }
#right-popup .quick-strip .qcard.right { justify-self: end   !important;  padding-right: 4px !important; }

/* 중앙 ‘차량 오차’는 스트립 아래 중앙에 띄워 겹침 방지(원하면 수치로 더 내리기) */
#right-popup .quick-strip .qcard.center{
  position: absolute !important;
  left: 50% !important;
  top: calc(100% + 6px) !important;         /* 더 내리고 싶으면 10~14px */
  transform: translateX(-50%) !important;
  pointer-events: none !important;
  text-align: center !important;
}

/* 3D 레이어 관계 유지 */
#right-popup .cluster-card .tractor-graphic-view{ position: relative !important; z-index: 0 !important; }
#right-popup .cluster-card .tractor-graphic-view::after{ z-index: 0 !important; }
#right-popup .cluster-card #renderCanvas{ z-index: 1 !important; }
/* 차량 오차 숫자 더 크게 */
#right-popup #vehicle-error-big{ 
  font-size: 72px !important;   /* 56→72px 등 원하는 값 */
  line-height: 1 !important;
}

/* 단위(cm)도 약간 키우고 간격 */
#right-popup .center-error-value small{
  font-size: 22px !important;
  margin-left: 6px !important;
}

/* 숫자 위치 '올리기/내리기' (스트립 아래 기준) */
#right-popup .quick-strip .qcard.center{
  top: calc(100% + -10px) !important; 
  /* ↑ 더 '올리고' 싶으면 2px → 0px 또는 음수, 
     더 '내리고' 싶으면 2px → 6~12px 로 늘리면 됩니다. */
}
/* === 차량오차 숫자: 기준을 quick-strip → 카드 전체로 변경 === */
:root{
  --err-top: 70px;           /* 카드 상단에서부터의 Y 위치. 음수/양수 모두 가능 */
  --qs-side-gutter: 18px;    /* quick-strip 좌우 여백(수신상태 잘림 방지) */
}

/* 카드가 위치 기준이 되도록 */
#right-popup .digital-cluster-container.cluster-card{
  position: relative !important;
  overflow: hidden; /* 카드 밖만 자름. 카드 내부 이동은 정상 표시 */
}

/* quick-strip은 흐름만 담당(가운데 값을 담지 않음) */
#right-popup .cluster-card .quick-strip{
  position: static !important;
  width: calc(100% - (var(--qs-side-gutter) * 2)) !important;
  margin: 0 auto 38px !important;  /* 아래는 숫자 들어갈 공간 */
  padding: 0 !important;
  display: grid !important;
  grid-template-columns: max-content 1fr max-content !important;
  align-items: center !important;
  overflow: visible !important;
}

/* 가운데 qcard(차량오차)를 카드 중앙에 절대 배치 */
#right-popup .cluster-card .quick-strip .qcard.center{
  position: absolute !important;
  left: 50% !important;
  top: var(--err-top) !important;      /* ↑ 이 값을 '작게/음수'로 하면 위로 올라감 */
  transform: translateX(-50%) !important;
  pointer-events: none !important;
  z-index: 50 !important;              /* 윗 행/캔버스보다 항상 위 */
  margin: 0 !important;
  padding: 0 !important;
  text-align: center !important;
}

/* 좌/우는 가장자리 여유만 살짝 줘서 잘림 방지 */
#right-popup .cluster-card .quick-strip .qcard.left  { justify-self: start !important;  padding-left: 4px !important; }
#right-popup .cluster-card .quick-strip .qcard.right { justify-self: end !important;    padding-right: 4px !important; }

/* 레이어 관계(캔버스/도로는 뒤) */
#right-popup .cluster-card .tractor-graphic-view,
#right-popup .cluster-card .tractor-graphic-view::after{ z-index: 0 !important; }
#right-popup .cluster-card #renderCanvas{ z-index: 1 !important; }
:root{
  --err-top: +150px;   /* 더 위로 */
  /* --err-top: -10px;  // 스트립보다 위로 띄우고 싶을 때 */
}
/* 기본: 흰색 */
#right-popup #vehicle-error-big{ 
  color:#fff !important;
  text-shadow: none !important; /* 필요하면 유지/삭제 */
}

/* 전복 경고가 표시될 때(팝업이 hidden이 아닐 때) → 빨강 */
body:has(#rollover-alert-popup:not(.hidden)) #right-popup #vehicle-error-big{
  color:#eb1e1e !important;
  text-shadow: 0 2px 10px rgba(255,90,90,.25) !important;
}

/* 주행주의일 때(바디에 driving-caution-active 클래스를 붙였을 때) → 호박색 */
body.driving-caution-active #right-popup #vehicle-error-big{
  color:#ffb74d !important;
  text-shadow: 0 2px 10px rgba(255,183,77,.25) !important;
}

/* (선택) 상단 작은 수치도 같은 규칙을 적용하고 싶다면 주석 해제
#right-popup #deviation-value{ color:#fff !important; }
body:has(#rollover-alert-popup:not(.hidden)) #right-popup #deviation-value{ color:#ff5a5a !important; }
body.driving-caution-active #right-popup #deviation-value{ color:#ffb74d !important; }
*/
/* ===== 차량오차 색상 최종 오버라이드 ===== */






/* ===== 위험도 색상 최종 규칙 (맨 끝에 둬야 함) ===== */

/* 기본: 흰색 */
#right-popup #vehicle-error-big,
#right-popup #deviation-value{
  color:#fff !important;
  text-shadow:none !important;
}

/* 경고(빨강) */
body[data-risk="warning"] #right-popup #vehicle-error-big,
body[data-risk="warning"] #right-popup #deviation-value{
  color:#ee1c1c !important;
  text-shadow:0 2px 10px rgba(255,77,77,.25) !important;
}

/* 주의(호박색) — 최우선. 경고보다 '아래'에 둬서 항상 이김 */
body[data-risk="caution"] #right-popup #vehicle-error-big,
body[data-risk="caution"] #right-popup #deviation-value{
  color:#ffb74d !important;
  text-shadow:0 2px 10px rgba(255,183,77,.22) !important;
}
/* 날씨 행: 온도를 맨 우측으로 */
#right-popup .digital-cluster-container.cluster-card .weather-row{
  display: flex !important;
  align-items: center !important;
  gap: 8px !important;               /* 라벨-아이콘 간격 */
}

/* 두 번째 위젯(43°)을 오른쪽 끝으로 밀기 */
#right-popup .digital-cluster-container.cluster-card .weather-row .cluster-widget:last-child{
  margin-left: auto !important;
}
